import cv2
import numpy as np
from CameraFit import Camerafit

# NOTE: Define landmark points in pixel and GPS space
lm_points_px = np.array([
   # [1921, 1081], 
    [1920, 555], [918, 454], [3390, 835], [2947, 559], [2759, 554],
    [2030, 367], [1247, 445], [935, 535], [275, 910], [2214, 1876], [1172, 1842],
    [3058, 1158], [3216, 1705], [2388, 1052], [1138, 1114], [678, 1480], [3171, 805], [2073, 1542]
])

# NOTE: Define actual coordinates of landmark points above, in the same order (format: lat, lon, elevation)
lm_points_gps = np.array([
    #(39.97109148165551, -86.07059324551214, 0), 
    (39.97120505130073, -86.07068980503063, 0),
    (39.97117973342699, -86.07099074506144, 0), (39.97129088113282, -86.07043909638733, 0),
    (39.971388093518286, -86.07055826701301, 0), (39.97135314912572, -86.07059581793686, 0),
    (39.97138603796625, -86.07082849955431, 0), (39.971222621382786, -86.07092103576453, 0),
    (39.97114759351012, -86.07091500080473, 0), (39.97100267643062, -86.07082782901239, 0),
    (39.971025762232664, -86.07051500870425, 0), (39.970994138962425, -86.07056942252174, 0),
    (39.9711438984383, -86.07048059274058, 0), (39.97107486291342, -86.07044793785327, 0),
    (39.97112117910931, -86.0705567460026, 0), (39.97104374840547, -86.0706531424601, 0),
    (39.970990817654894, -86.07063503755037, 0), (39.971265690219575, -86.07048260439721, 0),
    (39.9710472870819, -86.07053960133521, 0)
])

camera = Camerafit(fitconfig='autofit.yaml',px_location=lm_points_px,gps_location=lm_points_gps)

camera.show_perf()

topview_im = camera.topview()
cv2.imwrite('topview1.jpg',topview_im)

camera.save_cam()